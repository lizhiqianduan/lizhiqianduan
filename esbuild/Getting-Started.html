<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>开始 | esbuild 中文文档 | 前端文档库 | 励志前端</title>
    <meta name="description" content="用于存放前端中文文档，用于整理记录个人心得">
    <link rel="stylesheet" href="/assets/style.b7aed420.css">
    <link rel="modulepreload" href="/assets/app.807c2347.js">
    <link rel="modulepreload" href="/assets/esbuild_Getting-Started.md.23b7b0a2.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-283aed2f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-d2f860ef></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-d2f860ef> Skip to content </a><!--]--><!----><header class="VPNav" data-v-283aed2f data-v-29c86fca><div class="VPNavBar has-sidebar" data-v-29c86fca data-v-1bba32b4><div class="container" data-v-1bba32b4><div class="VPNavBarTitle has-sidebar" data-v-1bba32b4 data-v-74474907><a class="title" href="/" data-v-74474907><!--[--><!--]--><!--[--><img class="VPImage logo" src="/logo.jpg" alt data-v-877ec348><!--]--><!--[-->前端文档库 | 励志前端<!--]--><!--[--><!--]--></a></div><div class="content" data-v-1bba32b4><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-1bba32b4 data-v-1c1da10f><span id="main-nav-aria-label" class="visually-hidden" data-v-1c1da10f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/index.html" data-v-1c1da10f data-v-6abce2c4 data-v-84bb6c36><!--[-->首页<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/esbuild/index.html" data-v-1c1da10f data-v-6abce2c4 data-v-84bb6c36><!--[-->esbuild中文文档<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/changelog.html" data-v-1c1da10f data-v-6abce2c4 data-v-84bb6c36><!--[-->更新日志<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-1bba32b4 data-v-c1fcb3b8><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-c1fcb3b8 data-v-6f2ed4c7 data-v-4c835d9b><span class="check" data-v-4c835d9b><span class="icon" data-v-4c835d9b><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-6f2ed4c7><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-6f2ed4c7><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-1bba32b4 data-v-7b42e01b data-v-66bb75ee><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-66bb75ee><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-66bb75ee><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-66bb75ee><div class="VPMenu" data-v-66bb75ee data-v-0c1185a3><!----><!--[--><!--[--><!----><div class="group" data-v-7b42e01b><div class="item appearance" data-v-7b42e01b><p class="label" data-v-7b42e01b>Appearance</p><div class="appearance-action" data-v-7b42e01b><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-7b42e01b data-v-6f2ed4c7 data-v-4c835d9b><span class="check" data-v-4c835d9b><span class="icon" data-v-4c835d9b><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-6f2ed4c7><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-6f2ed4c7><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-1bba32b4 data-v-a521a5b3><span class="container" data-v-a521a5b3><span class="top" data-v-a521a5b3></span><span class="middle" data-v-a521a5b3></span><span class="bottom" data-v-a521a5b3></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-283aed2f data-v-4abc1a44><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-4abc1a44><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-4abc1a44><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-4abc1a44>Menu</span></button><a class="top-link" href="#" data-v-4abc1a44> Return to top </a></div><aside class="VPSidebar" data-v-283aed2f data-v-c36f1e35><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-c36f1e35><span class="visually-hidden" id="sidebar-aria-label" data-v-c36f1e35> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-c36f1e35><section class="VPSidebarGroup" data-v-c36f1e35 data-v-cccac61b><div class="title" data-v-cccac61b><h2 class="title-text" data-v-cccac61b>esbuild 中文文档</h2><div class="action" data-v-cccac61b><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-cccac61b><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-cccac61b><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-cccac61b><!--[--><!--[--><a class="VPLink link link" href="/esbuild/index.html" style="padding-left:0px;" data-v-a3d4d9a4 data-v-84bb6c36><!--[--><span class="link-text" data-v-a3d4d9a4>简介</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/esbuild/Getting-Started.html" style="padding-left:0px;" data-v-a3d4d9a4 data-v-84bb6c36><!--[--><span class="link-text" data-v-a3d4d9a4>开始</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/esbuild/API.html" style="padding-left:0px;" data-v-a3d4d9a4 data-v-84bb6c36><!--[--><span class="link-text" data-v-a3d4d9a4>API</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/esbuild/Content-Types.html" style="padding-left:0px;" data-v-a3d4d9a4 data-v-84bb6c36><!--[--><span class="link-text" data-v-a3d4d9a4>支持的Content类型</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/esbuild/Plugins.html" style="padding-left:0px;" data-v-a3d4d9a4 data-v-84bb6c36><!--[--><span class="link-text" data-v-a3d4d9a4>插件</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/404.html" style="padding-left:0px;" data-v-a3d4d9a4 data-v-84bb6c36><!--[--><span class="link-text" data-v-a3d4d9a4>FAQ</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/404.html" style="padding-left:0px;" data-v-a3d4d9a4 data-v-84bb6c36><!--[--><span class="link-text" data-v-a3d4d9a4>bundle包大小分析</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-283aed2f data-v-060306e3><div class="VPDoc has-sidebar has-aside" data-v-060306e3 data-v-cca40933><div class="container" data-v-cca40933><div class="aside" data-v-cca40933><div class="aside-curtain" data-v-cca40933></div><div class="aside-container" data-v-cca40933><div class="aside-content" data-v-cca40933><div class="VPDocAside" data-v-cca40933 data-v-e2ae63e2><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-e2ae63e2 data-v-c26a3ff9><div class="content" data-v-c26a3ff9><div class="outline-marker" data-v-c26a3ff9></div><div class="outline-title" data-v-c26a3ff9>目录导航</div><nav aria-labelledby="doc-outline-aria-label" data-v-c26a3ff9><span class="visually-hidden" id="doc-outline-aria-label" data-v-c26a3ff9> Table of Contents for current page </span><ul class="root" data-v-c26a3ff9 data-v-e83e3aea><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-e2ae63e2></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-cca40933><div class="content-container" data-v-cca40933><!--[--><!--]--><main class="main" data-v-cca40933><div style="position:relative;" class="vp-doc _esbuild_Getting-Started" data-v-cca40933><div><h1 id="开始" tabindex="-1">开始 <a class="header-anchor" href="#开始" aria-hidden="true">#</a></h1><h2 id="安装esbuild" tabindex="-1">安装esbuild <a class="header-anchor" href="#安装esbuild" aria-hidden="true">#</a></h2><p>首先，在本地下载并安装esbuild命令。可以使用npm（在安装NodeJs时会自动安装）安装预构建的本地可执行文件：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm install --save-exact esbuild</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>这条命令执行后，应该就已经在本地<code>node_modules</code>文件夹中安装了esbuild。您可以运行esbuild可执行文件来验证一切是否正常工作：</p><div class="language-"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">./node_modules/.bin/esbuild --version</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>建议安装esbuild的方法是使用npm安装本机可执行文件。但如果你不想这样做，还有一些其他的安装方法。</p><h2 id="您的第一个bundle" tabindex="-1">您的第一个<code>bundle</code> <a class="header-anchor" href="#您的第一个bundle" aria-hidden="true">#</a></h2><p>这是一个关于esbuild功能以及如何快速使用它的真实示例。首先，安装react和react dom包：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm install react react</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">dom</span></span>
<span class="line"></span></code></pre></div><p>然后创建一个名为<code>app.jsx</code>的文件，其中包含以下代码：</p><div class="language-jsx"><button title="Copy Code" class="copy"></button><span class="lang">jsx</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> React </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> Server </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">react-dom/server</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> Greet </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">Hello, world!</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">h1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(Server</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">renderToString</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&lt;</span><span style="color:#FFCB6B;">Greet</span><span style="color:#89DDFF;"> /&gt;</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"></span></code></pre></div><p>最后，告诉esbuild如何打包这个文件：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">./node_modules/.bin/esbuild app.jsx </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">bundle </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">outfile</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">out.js</span></span>
<span class="line"></span></code></pre></div><p>执行这个构建命令后，应该会创建一个名为out.js的文件，其中包含您的代码和打包在一起的React库。代码是完全独立的，不再依赖于node_modules目录。如果您使用<code>node out.js</code>运行代码，应该会看到如下内容：</p><div class="language-txt"><button title="Copy Code" class="copy"></button><span class="lang">txt</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">&lt;h1 data-reactroot=&quot;&quot;&gt;Hello, world!&lt;/h1&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>请注意，esbuild还将JSX语法转换为JavaScript，除了<code>.JSX</code>扩展名之外没有任何其他配置。虽然可以对esbuild进行配置，但这里尝试使用默认值，这样才能让更多的通用情况自动运行。如果您想在<code>.js</code>文件中使用<code>JSX语法</code>，可以使用<code>--loader:.js=JSX</code>标志告诉<code>esbuild</code>允许这样做。您可以在<code>API文档</code>中阅读有关可用配置选项的更多信息。</p><h2 id="构建脚本" tabindex="-1">构建脚本 <a class="header-anchor" href="#构建脚本" aria-hidden="true">#</a></h2><p>您的build命令将重复运行，因此您可能想要将它自动化。一种自然的方法是将构建脚本添加到<code>package.json</code>文件中，如下所示：</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">esbuild app.jsx --bundle --outfile=out.js</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>请注意，这里直接使用了esbuild命令，而没有使用相对路径。这是因为<code>scripts</code>部分中的所有内容都是使用路径中已经存在的<code>esbuild</code>命令运行的（只要您安装了esbuild包）。</p><p>构建脚本可以这样调用：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm run build</span></span>
<span class="line"></span></code></pre></div><p>但是，如果您需要将更多的选项传递给esbuild，那么使用命令行界面可能会变得非常困难。对于更复杂的使用场景，您可能希望使用<code>esbuild</code>的<code>JavaScript API</code>在<code>JavaScript</code>中编写构建脚本。可能像下面这样：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">require</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">esbuild</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">build</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">entryPoints</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">app.jsx</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">bundle</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">outfile</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">out.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">catch</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> process</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">exit</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">))</span></span>
<span class="line"></span></code></pre></div><p><code>build函数</code>在子进程中运行esbuild可执行文件，当build执行完成后，返回一个promise。上面的代码不会打印出捕获到的异常，因为默认情况下，异常中的任何错误消息也会打印到控制台（如果您愿意，可以更改日志级别来关闭它）。</p><p>虽然也有一个非异步的<code>buildSync API</code>，但异步API对于构建脚本更好，因为插件只能与异步API一起工作。您可以在API文档中阅读有关构建API的配置选项的更多信息。</p><h2 id="浏览器环境打包" tabindex="-1">浏览器环境打包 <a class="header-anchor" href="#浏览器环境打包" aria-hidden="true">#</a></h2><p>默认情况下，<code>bundler</code>为浏览器输出代码，因此启动时不需要额外的配置。对于开发版本，您可能希望使用<code>--sourcemap</code>启用源码映射，而对于生产版本，可能希望使用<code>--minify</code>启用代码压缩。您可能还希望为您支持的浏览器配置<code>target</code>环境，以便将最新的<code>JavaScript语法</code>转换为旧的<code>JavaScript</code>语法。所有这些加起来后，可能看起来像这样：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">esbuild app.jsx </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">bundle </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">minify </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">sourcemap </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">target</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">chrome58,firefox57,safari11,edge16</span></span>
<span class="line"></span></code></pre></div><p>某些npm包可能不是设计为在浏览器中运行的。有时，您可以使用esbuild的配置选项来解决某些问题，无论如何都能成功地打包。在简单的情况下，可以用define特性替换未定义的全局变量，在更复杂的情况下可以用inject特性替换。</p><h2 id="node环境打包" tabindex="-1">Node环境打包 <a class="header-anchor" href="#node环境打包" aria-hidden="true">#</a></h2><p>虽然在使用node的时候打包不是必需的，但有时在node中运行代码之前使用<code>esbuild</code>处理代码仍然是有好处的。打包可以自动剥离<code>TypeScript</code>类型，将<code>ECMAScript</code>模块语法转换为<code>CommonJS</code>，并将较新的JavaScript语法转换为特定版本节点的较旧语法。在发布软件包之前打包也是有好处的，这样下载量就更小，在从文件系统读取源代码的时间也更少。</p><p>如果需要打包为在<code>node</code>中运行的代码，则应通过将<code>--platform=node</code>传递给<code>esbuild</code>来配置平台设置。这个参数同时也会将一些不同的设置更改为对<code>node</code>环境较友好的默认值。例如，所有内置于节点（如<code>fs</code>）的包都会自动标记为外部包，因此<code>esbuild</code>不会试图去将它们打包。此设置还禁用<code>package.json</code>中<code>browser</code>字段的解释。</p><p>如果您的代码使用了在您的node版本中不起作用的较新的JavaScript语法，则需要配置node的目标版本：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">esbuild app.js </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">bundle </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">platform</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">node </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">target</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">node10</span><span style="color:#F78C6C;">.4</span></span>
<span class="line"></span></code></pre></div><p>您可能还不想将依赖项<code>dependencies</code>与<code>esbuild</code>打包在一起。还有很多<code>node</code>独有的特性是<code>esbuild</code>打包时不支持的，例如<code>__dirname</code>、<code>i<wbr>mport.meta.url</code>、<code>fs.readFileSync</code>和<code>*.node</code>原生二进制模块。通过将<code>packages</code>设置为<code>external</code>，可以从打包文件中排除所有依赖项：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">esbuild app.jsx </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">bundle </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">platform</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">node </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">packages</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">external</span></span>
<span class="line"></span></code></pre></div><p>这样做的话，在运行时文件系统上必须存在这些依赖项，因为它们不包含在打包文件中。</p><h2 id="多平台同步" tabindex="-1">多平台同步 <a class="header-anchor" href="#多平台同步" aria-hidden="true">#</a></h2><p>您不能在一个操作系统上安装<code>esbuild</code>，在不重新安装的情况下将<code>node_modules</code>目录复制到其他操作系统，然后在该其他操作系统上运行<code>esbuild</code>。这是行不通的，因为<code>esbuild</code>是用原生代码编写的，需要安装特定平台的二进制可执行文件。通常情况下，这没什么问题，因为您通常会将<code>package.json</code>文件纳入版本控制，而不是<code>node_modules</code>目录，然后每个人在克隆存储库后都会在本地计算机上运行<code>npm install</code>。</p><p>然而，人们有时会遇到这种情况，在<code>Windows</code>或<code>macOS</code>上安装esbuild，并将<code>node_modules</code>目录复制到运行<code>Linux</code>的<code>Docker</code>映像中，或者在<code>Windows</code>和<code>WSL</code>环境之间复制<code>node_module</code>目录。这么操作要想正确运行就取决于您的包管理器了：</p><p><code>npm/pnpm</code>：如果使用npm或pnpm进行安装，则可以在复制文件时尝试不复制<code>node_modules</code>目录，并在复制后在目标平台上运行<code>npm-ci</code>或<code>npm-install</code>。或者您可以考虑改用<code>Yarn</code>，它内置支持在多个平台上同时安装软件包。</p><p><code>Yarn</code>：如果您使用Yarn进行安装，可以尝试使用<code>supportedArchitectures</code>功能在<code>.yarnrc.yml</code>文件中列出当前平台和其他平台。请记住，这就意味着<code>esbuild</code>的多个副本将出现在文件系统中。</p><p>您可能还会遇到另一种情况，如果您在带有<code>ARM</code>处理器的<code>macOS</code>计算机上，使用npm的ARM版本安装esbuild，然后尝试使用<code>Rosetta</code>内部运行的<code>x86-64</code>版本的<code>node</code>运行<code>esbuild</code>。在这种情况下，一个简单的解决方案是使用ARM版本的node运行代码，可以在此处下载：<a href="https://nodejs.org/en/download/" target="_blank" rel="noreferrer">https://nodejs.org/en/download/</a>.</p><p>另一种选择是使用<code>esbuild-wasm</code>打包，这在所有平台上都是一样的。但它的性能成本很高，有时会比<code>esbuild</code>打包慢10倍，因此您可能也不想这样做。</p><h2 id="使用yarn-plug-n-play-pnp" tabindex="-1">使用Yarn <code>Plug&#39;n&#39;Play</code>(PnP) <a class="header-anchor" href="#使用yarn-plug-n-play-pnp" aria-hidden="true">#</a></h2><p>esbuild原生支持Yarn的<code>Plug&#39;n&#39;Play</code>包安装策略。要使用它，请确保您运行esbuild的当前工作目录包含Yarn生成的包清单JavaScript文件（<code>.pnp.cjs</code>或<code>.pnp.js</code>）。如果检测到<code>Yarn Plug&#39;n&#39;Play</code>包清单，esbuild将自动导入<code>Yarn</code>缓存中<code>.zip</code>文件内的包，并且将在捆绑期间自动动态提取这些文件。</p><p>因为<code>esbuild</code>是在<code>Go</code>中编写的，所以对<code>Yarn Plug&#39;n&#39;Play</code>的支持已经在<code>Go</code>中完全重新实现，而不是依赖<code>Yarn</code>的<code>JavaScript API</code>。这使得<code>Yarn Plug&#39;n&#39;Play</code>包解决方案能够与<code>esbuild</code>的并行打包很好地集成，以实现最高速度。注意，Yarn的命令行界面为每个命令增加了许多不可避免的性能开销。为了获得最大的esbuild性能，您可能需要考虑在不使用<code>Yarn</code>的<code>CLI</code>的情况下运行<code>esbuild</code>（即不使用<code>Yarn esbuild</code>）。这会让<code>esbuild</code>运行速度提高10倍。</p><h2 id="其他安装方式" tabindex="-1">其他安装方式 <a class="header-anchor" href="#其他安装方式" aria-hidden="true">#</a></h2><p>建议安装<code>esbuild</code>的方法是使用<code>npm</code>安装本机可执行文件。但也可以通过以下方式安装esbuild：</p><h3 id="下载构建后的可执行文件" tabindex="-1">下载构建后的可执行文件 <a class="header-anchor" href="#下载构建后的可执行文件" aria-hidden="true">#</a></h3><p>如果您有Unix系统，可以使用以下命令下载当前平台的esbuild二进制可执行文件（它将被下载到当前工作目录）：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">curl </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">fsSL https://esbuild.github.io/dl/v0</span><span style="color:#F78C6C;">.16.13</span><span style="color:#A6ACCD;"> | sh</span></span>
<span class="line"></span></code></pre></div><p>您还可以使用最新版本而不是版本号来下载esbuild的最新版本：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">curl </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">fsSL https://esbuild.github.io/dl/latest | sh</span></span>
<span class="line"></span></code></pre></div><p>如果您不想从互联网上执行<code>shell</code>脚本以下载<code>esbuild</code>，您也可以自己从<code>npm</code>手动下载包（这就是上述shell脚本所做的全部工作）。虽然预编译的本地可执行文件是使用<code>npm</code>托管的，但实际上不需要安装npm来下载它们。npm包的<code>registry</code>是一个普通的<code>HTTP</code>服务器，包是普通的<code>gzip tar</code>文件。</p><p>以下是直接下载二进制可执行文件的示例：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">curl </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">O https://registry.npmjs.org/@esbuild/darwin</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">x64/</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">/darwin</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">x64</span><span style="color:#F78C6C;">-0.16.13</span><span style="color:#A6ACCD;">.tgz</span></span>
<span class="line"><span style="color:#A6ACCD;">tar xzf ./darwin</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">x64</span><span style="color:#F78C6C;">-0.16.13</span><span style="color:#A6ACCD;">.tgz</span></span>
<span class="line"><span style="color:#A6ACCD;">./package/bin/esbuild</span></span>
<span class="line"><span style="color:#A6ACCD;">Usage:</span></span>
<span class="line"><span style="color:#A6ACCD;">  esbuild [options] [entry points]</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">...</span></span>
<span class="line"></span></code></pre></div><p><code>@esbuild/darwin-x64</code>包中的原生可执行文件适用于<code>macOS</code>操作系统和64位<code>Intel</code>体系结构的操作系统。截至本文撰写之时，这是esbuild支持的平台的本地可执行包的完整列表：</p><table><thead><tr><th>Package name</th><th>OS</th><th>Architecture</th><th>Download</th></tr></thead><tbody><tr><td>@esbuild/android-arm</td><td>android</td><td>arm</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/android-arm64</td><td>android</td><td>arm64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/android-x64</td><td>android</td><td>x64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/darwin-arm64</td><td>darwin</td><td>arm64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/darwin-x64</td><td>darwin</td><td>x64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/freebsd-arm64</td><td>freebsd</td><td>arm64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/freebsd-x64</td><td>freebsd</td><td>x64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/linux-arm</td><td>linux</td><td>arm</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/linux-arm64</td><td>linux</td><td>arm64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/linux-ia32</td><td>linux</td><td>ia32</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/linux-loong64</td><td>linux</td><td>loong642</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/linux-mips64el</td><td>linux</td><td>mips64el2</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/linux-ppc64</td><td>linux</td><td>ppc64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/linux-riscv64</td><td>linux</td><td>riscv642</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/linux-s390x</td><td>linux</td><td>s390x</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/linux-x64</td><td>linux</td><td>x64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/netbsd-x64</td><td>netbsd1</td><td>x64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/openbsd-x64</td><td>openbsd</td><td>x64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/sunos-x64</td><td>sunos</td><td>x64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/win32-arm64</td><td>win32</td><td>arm64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/win32-ia32</td><td>win32</td><td>ia32</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr><tr><td>@esbuild/win32-x64</td><td>win32</td><td>x64</td><td><a href="https://esbuild.github.io/getting-started/#download-a-build" target="_blank" rel="noreferrer">⬇️</a></td></tr></tbody></table><p><strong>为什么不建议这样做</strong>：这种方法只适用于可以运行shell脚本的Unix系统，因为它需要Windows上的WSL。另外一个缺点是，您不能将插件与本机版本的esbuild一起使用。</p><p>如果您选择编写自己的代码来直接从npm下载esbuild，那么您将依赖<code>esbuild</code>的本地可执行安装程序的内部实现细节。这些细节可能会在某个时候发生变化，在某种情况下，这种方法将不再适用于新的esbuild版本。虽然这只是一个小缺点，但该方法对于现有的<code>esbuild</code>版本仍然可以永远使用（发布到<code>npm</code>的包是不可变的）。</p><h3 id="安装wasm版本" tabindex="-1">安装WASM版本 <a class="header-anchor" href="#安装wasm版本" aria-hidden="true">#</a></h3><p>除了<code>esbuild</code>npm包之外，还有一个<code>esbuild-wasm</code>包，其功能类似，但使用<code>WebAssembly</code>实现而不是原生代码。安装它也将安装一个名为<code>esbuild</code>的可执行文件：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">npm install </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">save</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">exact esbuild</span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">wasm</span></span>
<span class="line"></span></code></pre></div><p><strong>为什么不建议这样做</strong>：<code>WebAssembly</code>版本比原生版本慢得多。在许多情况下，它慢了一个数量级（即10倍）。这是出于各种原因，包括：</p><ul><li>a）node在每次运行时都会从头开始重新编译<code>WebAssembly</code>代码</li><li>b）Go的<code>WebAssembly</code>编译方法是单线程的</li><li>c）node有<code>WebAssembly</code>bug，进程退出可能会延迟几秒 <code>WebAssembly</code>版本还排除了一些功能，例如本地文件服务器。只有在没有其他选择的情况下，例如当您希望在不受支持的平台上使用<code>esbuild</code>时，才应该像这样使用<code>WebAssembly</code>包。WebAssembly包主要用于浏览器。</li></ul><h3 id="使用deno代替node" tabindex="-1">使用<code>Deno</code>代替<code>node</code> <a class="header-anchor" href="#使用deno代替node" aria-hidden="true">#</a></h3><p>如果您希望将<code>esbuild</code>与<code>Deno JavaScript</code>环境一起使用，<code>esbulid</code>也对其提供了基础支持。程序包位于<a href="https://deno.land/x/esbuild" target="_blank" rel="noreferrer">https://deno.land/x/esbuild</a>，并使用了原生esbuild可执行文件。可执行文件将在运行时从<code>npm</code>下载并缓存，因此您的计算机需要网络能访问<code>registry.npmjs.org</code>才能使用此包。使用软件包如下所示：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> esbuild </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://deno.land/x/esbuild@v0.16.13/mod.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ts </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">let test: boolean = true</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> result </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#A6ACCD;"> esbuild</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">transform</span><span style="color:#A6ACCD;">(ts</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">loader</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ts</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">result:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> result)</span></span>
<span class="line"><span style="color:#A6ACCD;">esbuild</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stop</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span></code></pre></div><p>它与<code>esbuild</code>的npm包基本上具有相同的API，但有一个额外之处：完成后需要调用<code>stop()</code>，因为与node不同，Deno没有提供必要的API来允许<code>Deno</code>在<code>esbuild</code>内部子进程仍在运行时退出。</p><p>如果您希望使用<code>esbuild</code>的<code>WebAssembly</code>版本来代替<code>esbuild</code>与<code>Deno</code>的原生版本，可以通过导入<code>wasm.js</code>代替<code>mod.js</code>来实现，如下所示：</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#A6ACCD;"> esbuild </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://deno.land/x/esbuild@v0.16.13/wasm.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ts </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">let test: boolean = true</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> result </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#A6ACCD;"> esbuild</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">transform</span><span style="color:#A6ACCD;">(ts</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">loader</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ts</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">result:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> result)</span></span>
<span class="line"><span style="color:#A6ACCD;">esbuild</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">stop</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span></code></pre></div><p>使用<code>WebAssembly</code>代替原生意味着您不需要指定<code>Deno</code>的<code>--allow</code>运行权限，而<code>WebAssembly</code>是文件系统不可用的情况下（如使用<code>Deno Deploy</code>）的唯一选择。但是，请记住，<code>esbuild</code>的<code>WebAssembly</code>版本比原生版本慢得多。关于WebAssembly的另一件事是，<code>Deno</code>目前有一个<code>bug</code>，在所有加载的<code>WebAssembly</code>模块完全优化之前，进程终止会被不必要地延迟，这可能需要几秒钟。如果您正在编写一个使用<code>esbuild</code>的<code>WebAssembly</code>实现的临时脚本，以便您的代码在合理的时间内退出，那么您可能需要在代码完成后手动调用<code>Deno.exit(0)</code>。</p><p><strong>不建议这样做的原因</strong>：<code>Deno</code>比<code>node</code>更新，使用较少，支持的平台也比<code>node</code>少，因此建议将node作为运行esbuild的主要方式。Deno使用了互联网作为包系统，而不是现有的JavaScript包生态系统，esbuild是围绕npm风格的包管理而设计和优化的。您可以将esbuild与Deno一起使用，但如果您想打包<code>HTTP URL</code>，则需要一个插件。</p><h3 id="从源码构建" tabindex="-1">从源码构建 <a class="header-anchor" href="#从源码构建" aria-hidden="true">#</a></h3><p>要从源生成<code>esbuild</code>，请执行以下操作：</p><ol><li>安装Go编译器：</li></ol><p><a href="https://go.dev/dl/" target="_blank" rel="noreferrer">https://go.dev/dl/</a></p><ol start="2"><li>下载esbuild的源代码：</li></ol><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">git clone </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">depth </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">--</span><span style="color:#A6ACCD;">branch v0</span><span style="color:#F78C6C;">.16.13</span><span style="color:#A6ACCD;"> https://github.com/evanw/esbuild.git</span></span>
<span class="line"><span style="color:#A6ACCD;">cd esbuild</span></span>
<span class="line"></span></code></pre></div><ol start="3"><li>构建esbuild可执行文件（在Windows上为esbuild.exe）：</li></ol><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">go build ./cmd/esbuild</span></span>
<span class="line"></span></code></pre></div><p>如果要为其他平台构建，只需在build命令前面加上平台信息即可。例如，可以使用以下命令构建32位Linux版本：</p><div class="language-cmd"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">GOOS</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">linux GOARCH</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">386</span><span style="color:#A6ACCD;"> go build ./cmd/esbuild</span></span>
<span class="line"></span></code></pre></div><p><strong>不建议这样做的原因</strong>：原生版本只能通过命令行界面使用，对于复杂的用例来说，这是很耗费时间的，并且不支持插件。您需要编写JavaScript或Go代码，并使用esbuild的API来使用插件。</p></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-cca40933 data-v-2fa08e9f><div class="edit-info" data-v-2fa08e9f><div class="edit-link" data-v-2fa08e9f><a class="VPLink link edit-link-button" href="https://github.com/lizhiqianduan/lizhiqianduan.github.io/blob/main/docs/esbuild/Getting-Started.md" target="_blank" rel="noreferrer" data-v-2fa08e9f data-v-84bb6c36><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" data-v-2fa08e9f><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> Edit this page on GitHub<!--]--><!----></a></div><div class="last-updated" data-v-2fa08e9f><p class="VPLastUpdated" data-v-2fa08e9f data-v-1141e748>Last updated: <time datetime="2023-01-09T09:04:18.000Z" data-v-1141e748></time></p></div></div><div class="prev-next" data-v-2fa08e9f><div class="pager" data-v-2fa08e9f><a class="pager-link prev" href="/esbuild/index.html" data-v-2fa08e9f><span class="desc" data-v-2fa08e9f>Previous page</span><span class="title" data-v-2fa08e9f>简介</span></a></div><div class="has-prev pager" data-v-2fa08e9f><a class="pager-link next" href="/esbuild/API.html" data-v-2fa08e9f><span class="desc" data-v-2fa08e9f>Next page</span><span class="title" data-v-2fa08e9f>API</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><!----><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"changelog.md\":\"6e788739\",\"404.md\":\"49503c76\",\"esbuild_content-types.md\":\"7e2c8273\",\"esbuild_api.md\":\"0b0518ba\",\"esbuild_getting-started.md\":\"23b7b0a2\",\"esbuild_index.md\":\"040d776a\",\"esbuild_plugins.md\":\"28717f67\",\"index.md\":\"15823578\"}")</script>
    <script type="module" async src="/assets/app.807c2347.js"></script>
    
  </body>
</html>